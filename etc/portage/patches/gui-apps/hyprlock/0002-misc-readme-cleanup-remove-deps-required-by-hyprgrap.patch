From 59416fbb37909779ba8c8d1adcbbed89c0c6381b Mon Sep 17 00:00:00 2001
From: Maximilian Seidler <78690852+PaideiaDilemma@users.noreply.github.com>
Date: Mon, 5 May 2025 23:45:32 +0200
Subject: [PATCH 2/3] misc: readme cleanup, remove deps required by
 hyprgraphics (#762)

---
 CMakeLists.txt                         |  5 +---
 README.md                              | 39 +++++++++++++-------------
 nix/default.nix                        |  6 ----
 src/renderer/AsyncResourceGatherer.cpp |  1 -
 4 files changed, 21 insertions(+), 30 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 8965b30..9319294 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -36,7 +36,7 @@ add_compile_definitions(HYPRLOCK_VERSION="${VERSION}")
 if (DEFINED HYPRLOCK_COMMIT)
   add_compile_definitions(HYPRLOCK_COMMIT="${HYPRLOCK_COMMIT}")
 else()
-   # get git commit
+  # get git commit
   execute_process(
     OUTPUT_VARIABLE GIT_SHORT_HASH
     OUTPUT_STRIP_TRAILING_WHITESPACE
@@ -82,9 +82,6 @@ pkg_check_modules(
   hyprlang>=0.6.0
   egl
   xkbcommon
-  libjpeg
-  libwebp
-  libmagic
   cairo
   pangocairo
   libdrm
diff --git a/README.md b/README.md
index e8cd34a..4e98c50 100644
--- a/README.md
+++ b/README.md
@@ -2,10 +2,14 @@
 Hyprland's simple, yet multi-threaded and GPU-accelerated screen locking utility.
 
 ## Features
- - uses the secure ext-session-lock protocol
- - full support for fractional-scale
- - fully GPU accelerated
- - multi-threaded resource acquisition for no hitches
+ - Uses the ext-session-lock protocol
+ - Support for fractional-scale
+ - Fully GPU accelerated
+ - Multi-threaded resource acquisition
+ - Blurred screenshot as the background
+ - Native fingerprint support (using libfprint's dbus interface)
+ - Some of Hyprland's eyecandy: gradient borders, blur, animations, shadows, etc.
+ - and more...
 
 ## How it looks
 
@@ -25,26 +29,23 @@ yay -S hyprlock-git # compiles from latest source
 
 ### Deps
 You need the following dependencies
-- wayland-client
-- wayland-protocols
-- mesa
-- hyprwayland-scanner
 
-And the development libraries for the following
 - cairo
-- libdrm
-- pango
-- xkbcommon
-- pam
+- hyprgraphics
+- hyprland-protocols
 - hyprlang
 - hyprutils
-- hyprgraphics
-- libmagic (file-devel on Fedora)
-
-Development libraries are usually suffixed with `-devel` or `-dev` in most distro repos.
+- hyprwayland-scanner
+- mesa (required is libgbm, libdrm and the opengl runtime)
+- pam
+- pango
+- sdbus-cpp (>= 2.0.0)
+- wayland-client
+- wayland-protocols
+- xkbcommon
 
-You also need to install `mesa-libgbm-devel` on some distros like RPM based ones where its not
-bundled with the mesa package.
+Sometimes distro packages are missing required development files.
+Such distros usually offer development versions of library package - commonly suffixed with `-devel` or `-dev`.
 
 ### Building
 
diff --git a/nix/default.nix b/nix/default.nix
index 0a192ff..d3c5105 100644
--- a/nix/default.nix
+++ b/nix/default.nix
@@ -4,11 +4,8 @@
   cmake,
   pkg-config,
   cairo,
-  file,
   libdrm,
   libGL,
-  libjpeg,
-  libwebp,
   libxkbcommon,
   libgbm,
   hyprgraphics,
@@ -40,11 +37,8 @@ stdenv.mkDerivation {
 
   buildInputs = [
     cairo
-    file
     libdrm
     libGL
-    libjpeg
-    libwebp
     libxkbcommon
     libgbm
     hyprgraphics
diff --git a/src/renderer/AsyncResourceGatherer.cpp b/src/renderer/AsyncResourceGatherer.cpp
index 5355a3f..b1a52de 100644
--- a/src/renderer/AsyncResourceGatherer.cpp
+++ b/src/renderer/AsyncResourceGatherer.cpp
@@ -2,7 +2,6 @@
 #include "../config/ConfigManager.hpp"
 #include "../core/Egl.hpp"
 #include <cairo/cairo.h>
-#include <magic.h>
 #include <pango/pangocairo.h>
 #include <algorithm>
 #include <filesystem>
-- 
2.51.0

